---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';

// 1. Get all posts
const allPosts = await getCollection('blog');

// 2. Safely get tags (filtering out any posts that might not have them)
const tags = [...new Set(allPosts.flatMap(post => post.data.tags || []))].filter(Boolean);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<h1>Hello, World!</h1>
			<p>
				hi this is my blog
			</p>
			<div class="tag-cloud">
				<h3>Explore by Tag:</h3>
				<div class="tags">
						{tags.map((tag) => (
							<a href={`/my-blog/tags/${tag}`}>#{tag}</a>
						))}
					</div>
			</div>
			<p>
				Stay tuned for more updates.
			</p>
		</main>
		<Footer />
	</body>
</html>

<style>
    /* Styling the container */
    .tag-cloud {
        margin: 2em 0;
        padding: 1em;
        background: rgba(255, 255, 255, 0.05); /* Slight highlight */
        border-radius: 8px;
    }
    
    /* Styling the buttons (Reuse of what we did before) */
    .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }
    
    .tags a {
        padding: 0.5em 1em;
        border: 1px solid var(--accent);
        border-radius: 99px;
        color: var(--accent);
        text-decoration: none;
        font-size: 0.9em;
        transition: all 0.2s;
    }
    
    .tags a:hover {
        background-color: var(--accent);
        color: white;
        transform: translateY(-2px); /* Little hop effect */
    }
</style>